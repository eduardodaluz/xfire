<project
  default="java:jar"
  xmlns:j="jelly:core"
  xmlns:plexus="plexus"
  xmlns:plexus-appserver="plexus-appserver"
  xmlns:deploy="deploy"
  xmlns:ant="jelly:ant"
  xmlns:i="jelly:interaction">

    
 <!--
   | Build us a runtime with plexus, summit and our application's
   | components.
   |-->  
  <goal name="doit">

    <attainGoal name="jar:install"/>
    <plexus:cdc/>

    <plexus:deploy
        base="${maven.build.dir}/runtime"
        plexusConfiguration="${basedir}/src/conf/plexus.xml"
        mavenRepoLocal="${maven.repo.local}"
        application="xfire-test"
        plexusVersion="0.14-SNAPSHOT"
        configurationPropertiesFile="${basedir}/src/conf/app.properties"
        componentManifest="${maven.repo.local}/plexus/plexus-component.manifest"
        projectPom="${basedir}/project.xml"/>

    <attainGoal name="deployWEBINF"/>

  </goal>


  <!--
   | Deploy the WEB-INF dir
   |-->

  <goal name="deployWEBINF">

    <mkdir dir="${basedir}/target/runtime/web-apps/test"/>

    <copy todir="${basedir}/target/runtime/web-apps/test">
      <fileset dir="${basedir}/resources">
        <include name="**/*"/>
      </fileset>
    </copy>
    
  </goal>

</project>
