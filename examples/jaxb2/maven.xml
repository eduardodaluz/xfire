<project default="jar:install" xmlns:j="jelly:core" 
	xmlns:ant="jelly:ant" xmlns:maven="jelly:maven" xmlns:i="jelly:interaction">

	<ant:path id="jaxb.path">
		<ant:path refid="maven.dependency.classpath" />
		<ant:pathelement path="${maven.build.dest}" />
		<ant:pathelement path="${maven.test.dest}" />
	</ant:path>

	
	<goal name="generate-jaxb">

		<ant:delete dir="${maven.build.dir}/generated" />
		<ant:mkdir dir="${maven.build.dir}/generated" />
		
		<!-- START SNIPPET: xjc -->
		<ant:taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask" classpathref="jaxb.path" />

		<xjc target="${maven.build.dir}/generated">
			<schema dir="src/main/META-INF/xfire" includes="*.xsd" />
		</xjc>
		<!-- END SNIPPET: xjc -->
		
		<ant:path id="xfire.jaxb.generated" location="${maven.build.dir}/generated" />
		<maven:addPath id="maven.compile.src.set" refid="xfire.jaxb.generated" />
	</goal>

	<preGoal name="java:compile">
		<attainGoal name="generate-jaxb" />
	</preGoal>

</project>
